I have yet to figure out how to correctly handle functions,
so the intrinsic function handling is bad
