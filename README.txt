Made no attempt at lambda, but otherwise quite pretty code in my view